<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Standalone WASM/WebGL Console (Mobile Friendly)</title>
  <style>
    body { margin: 0; background: #181818; color: #eee; font-family: monospace; }
    #webgl-canvas { display: block; width: 100vw; height: 80vh; background: #222; }
    #console { width: 100vw; height: 20vh; background: #111; color: #0f0; overflow-y: auto; }
    #input { width: 95vw; }
    #start-msg { position:absolute;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background:#222;color:#fff;z-index:10;font-size:2em;}
  </style>
</head>
<body>
  <div id="start-msg" onclick="startWasm()">Tap to start</div>
  <canvas id="webgl-canvas"></canvas>
  <div id="console"></div>
  <input id="input" placeholder="Type WASM export or JS command and press Enter">
  <script>
    function resizeCanvas() {
      const canvas = document.getElementById('webgl-canvas');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight * 0.8;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function log(msg) {
      const consoleDiv = document.getElementById('console');
      consoleDiv.innerHTML += msg + "<br>";
      consoleDiv.scrollTop = consoleDiv.scrollHeight;
    }

    function base64ToUint8Array(base64) {
      const binary = atob(base64);
      const bytes = new Uint8Array(binary.length);
      for (let i = 0; i < binary.length; i++) {
        bytes[i] = binary.charCodeAt(i);
      }
      return bytes;
    }

    function startWasm() {
      document.getElementById('start-msg').style.display = 'none';
      const wasmBase64 = "BASE64_WASM_STRING";
      const wasmBytes = base64ToUint8Array(wasmBase64);

      if (typeof WebAssembly.instantiate === "function") {
        WebAssembly.instantiate(wasmBytes.buffer, {
          env: {}
        }).then(obj => {
          window.wasmInstance = obj.instance;
          window.wasmExports = obj.instance.exports;
          log('WASM loaded. Available exports: ' + Object.keys(window.wasmExports).join(', '));
          // Optionally, initialize WebGL here using wasmExports
        }).catch(err => {
          log('WASM failed to load: ' + err);
        });
      } else {
        log('WebAssembly is not supported in this browser.');
      }
    }

    document.getElementById('input').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        const cmd = this.value;
        this.value = '';
        try {
          if (window.wasmExports && cmd in window.wasmExports) {
            const result = window.wasmExports[cmd]();
            log('> ' + cmd + '() = ' + result);
          } else {
            const result = eval(cmd);
            log('> ' + cmd + ' = ' + result);
          }
        } catch (err) {
          log('Error: ' + err);
        }
      }
    });
  </script>
</body>
</html>
